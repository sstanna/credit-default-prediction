# Credit Default Prediction Pipeline

???????????? ???? ?????????????????????????? ?????????????????? ?????? ?????????????????????? ???????????? ???????????????????????? ?????????????? (PD-????????????).

## ???????????????? ??????????????

???????? ???????????? ?????????????????? ???????????????? (end-to-end) ???????????????????????????????????? ???????????????? ????????????????????, ????????????????????????, ?????????????????????????? ?? ?????????????????????? ???????????? ?????????????????? ???????????????? ?????? ???????????????????????? ?????????????????????? ?????????????? ??????????????.

**??????????:** ?????????????? / ?????????????????? ??????????????  
**??????????????:** Default of Credit Card Clients Dataset ?? UCI Machine Learning Repository

## ?????????????????? ??????????????

`
????????? data/                   # ???????????? (raw, processed)
????????? models/                 # ?????????????????? ????????????
????????? notebooks/              # Jupyter notebooks ?????? EDA
????????? src/                    # ???????????????? ??????
???   ????????? data/              # ???????????? ?????? ???????????? ?? ??????????????
???   ????????? models/            # ???????????? ?????? ???????????????? ??????????????
???   ????????? api/               # FastAPI ????????????????????
???   ????????? monitoring/        # ???????????? ?????? ??????????????????????
????????? tests/                  # ??????????
????????? scripts/                # ?????????????? ?????? ??????????????
????????? .github/workflows/      # GitHub Actions
????????? dvc.yaml               # DVC pipeline
????????? Dockerfile             # Docker ????????????????????????
????????? requirements.txt       # ??????????????????????
`

## ?????????????????? ?? ????????????

### 1. ???????????????????????? ??????????????????????
`ash
git clone https://github.com/sstanna/credit-default-prediction.git
cd credit-default-prediction
`

### 2. ?????????????????? ????????????????????????
`ash
pip install -r requirements.txt
`

### 3. ???????????????????? ????????????
`ash
python -m src.data.load_data
`

### 4. ???????????????? ????????????
`ash
python scripts/train_models.py
`

### 5. ???????????? API
`ash
python scripts/run_api.py
# ??????
uvicorn src.api.app:app --host 0.0.0.0 --port 8000
`

### 6. ???????????? ????????????
`ash
pytest tests/ -v
`

### 7. ???????????????????? ????????????
`ash
python scripts/monitor_drift.py
`

### 8. Docker ????????????
`ash
docker build -t credit-default-api .
docker run -p 8000:8000 credit-default-api
`

## ???????????????????? ??????????????

### 1. ???????????????????? ?? ?????????????????? ????????????
- ???????????????? ???????????? ???? UCI ML Repository
- Feature Engineering (???????????????????????????? ????????????????, ??????????????)
- ?????????????????? ?? Great Expectations

### 2. ???????????????? ????????????
- Sklearn Pipeline ?? ????????????????????????????
- ???????????????????????????? ???????????? ??????????????????????????????
- ??????????????: ROC-AUC, Precision, Recall, F1-Score

### 3. ??????????????????????????????????????
- MLflow Tracking ?????? ?????????????????????? ??????????????????????????
- ?????????????????????????????? ?????????????? ?? ???????????? ?? DVC

### 4. ???????????????????????? ?? CI/CD
- Unit-?????????? ?? pytest
- GitHub Actions ?????? ?????????????????????????????? ????????????????????????
- ?????????????? ?? flake8 ?? ???????????????????????????? ?? black

### 5. ??????????????????????????
- FastAPI REST API
- Docker ??????????????????????????????
- ???????????????????? ???????????? ????????????

## API Endpoints

- GET / - ???????????????????? ?? API
- POST /predict - ???????????????????????? ??????????????
- GET /health - ???????????????? ???????????????? ??????????????
- POST /predict_batch - ???????????????? ????????????????????????
- GET /model_info - ???????????????????? ?? ????????????

## ???????????? ?????????????????????????? API

`python
import requests

url = "http://localhost:8000/predict"
data = {
    "LIMIT_BAL": 20000,
    "SEX": 2,
    "EDUCATION": 2,
    "MARRIAGE": 1,
    "AGE": 24,
    "PAY_0": 2,
    "PAY_2": 2,
    "PAY_3": -1,
    "PAY_4": -1,
    "PAY_5": -2,
    "PAY_6": -2,
    "BILL_AMT1": 3913,
    "BILL_AMT2": 3102,
    "BILL_AMT3": 689,
    "BILL_AMT4": 0,
    "BILL_AMT5": 0,
    "BILL_AMT6": 0,
    "PAY_AMT1": 0,
    "PAY_AMT2": 689,
    "PAY_AMT3": 0,
    "PAY_AMT4": 0,
    "PAY_AMT5": 0,
    "PAY_AMT6": 0
}

response = requests.post(url, json=data)
print(response.json())
`

## ????????????????????

???????????? src/monitoring/drift_monitor.py ?????????????????????? ?????????? ???????????? ?? ?????????????????? Population Stability Index (PSI).

`python
from src.monitoring.drift_monitor import DataDriftMonitor

monitor = DataDriftMonitor(reference_data)
report = monitor.generate_drift_report(new_data)
`

## MLflow Tracking

???????????? MLflow UI:
`ash
mlflow ui
`

???????????????? http://localhost:5000 ?? ???????????????? ?????? ?????????????????? ??????????????????????????.

## DVC Pipeline

???????????? ??????????????????:
`ash
dvc repro
`

## ????????????????????????

???????????? ???????? ????????????:
`ash
pytest tests/ -v --cov=src
`

???????????? ????????????????:
`ash
flake8 src tests
black src tests
`

## ????????????????????

- **??????????????:** 30,000 ?????????????? ?????????????? ????????????????????
- **?????????????? ????????????????????:** 22.12% ???????????????? (6,636 ???? 30,000)
- **Feature Engineering:** 4 ?????????? ???????????????? ??????????????
- **????????????:** 3 ?????????????????? ?????????????? ?? ????????????????????????????????
- **API:** REST API ?????????? ?? ???????????????? ??????????????????????????
- **????????????????????:** PSI ?????????? ???????????????? ????????????????????

## ??????????

???????????? ??????????????

## ????????????????

MIT License
