# Credit Default Prediction Pipeline

ÐŸÑ€Ð¾ÐµÐºÑ‚ Ð¿Ð¾ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ð¿Ð°Ð¹Ð¿Ð»Ð°Ð¹Ð½Ð° Ð´Ð»Ñ ÑÐºÐ¾Ñ€Ð¸Ð½Ð³Ð¾Ð²Ð¾Ð¹ Ð¼Ð¾Ð´ÐµÐ»Ð¸ Ð¿Ñ€ÐµÐ´ÑÐºÐ°Ð·Ð°Ð½Ð¸Ñ Ð´ÐµÑ„Ð¾Ð»Ñ‚Ð° (PD-Ð¼Ð¾Ð´ÐµÐ»ÑŒ).

## ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°

Ð­Ñ‚Ð¾Ñ‚ Ð¿Ñ€Ð¾ÐµÐºÑ‚ Ñ€ÐµÐ°Ð»Ð¸Ð·ÑƒÐµÑ‚ ÑÐºÐ²Ð¾Ð·Ð½Ð¾Ð¹ (end-to-end) Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ Ð¿Ð°Ð¹Ð¿Ð»Ð°Ð¹Ð½ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸, Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ, Ñ€Ð°Ð·Ð²Ñ‘Ñ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ñ Ð¸ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³Ð° Ð¼Ð¾Ð´ÐµÐ»Ð¸ Ð¼Ð°ÑˆÐ¸Ð½Ð½Ð¾Ð³Ð¾ Ð¾Ð±ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð´Ð»Ñ Ð¿Ñ€ÐµÐ´ÑÐºÐ°Ð·Ð°Ð½Ð¸Ñ Ð²ÐµÑ€Ð¾ÑÑ‚Ð½Ð¾ÑÑ‚Ð¸ Ð´ÐµÑ„Ð¾Ð»Ñ‚Ð° ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð°.

**Ð”Ð¾Ð¼ÐµÐ½:** Ñ„Ð¸Ð½Ð°Ð½ÑÑ‹ / ÐºÑ€ÐµÐ´Ð¸Ñ‚Ð½Ñ‹Ð¹ ÑÐºÐ¾Ñ€Ð¸Ð½Ð³  
**Ð”Ð°Ñ‚Ð°ÑÐµÑ‚:** Default of Credit Card Clients Dataset Ñ UCI Machine Learning Repository

## Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°

``
â”œâ”€â”€ data/                   # Ð”Ð°Ð½Ð½Ñ‹Ðµ (raw, processed)
â”œâ”€â”€ models/                 # ÐžÐ±ÑƒÑ‡ÐµÐ½Ð½Ñ‹Ðµ Ð¼Ð¾Ð´ÐµÐ»Ð¸
â”œâ”€â”€ notebooks/              # Jupyter notebooks Ð´Ð»Ñ EDA
â”œâ”€â”€ src/                    # Ð˜ÑÑ…Ð¾Ð´Ð½Ñ‹Ð¹ ÐºÐ¾Ð´
â”‚   â”œâ”€â”€ data/              # ÐœÐ¾Ð´ÑƒÐ»Ð¸ Ð´Ð»Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ñ Ð´Ð°Ð½Ð½Ñ‹Ð¼Ð¸
â”‚   â”œâ”€â”€ models/            # ÐœÐ¾Ð´ÑƒÐ»Ð¸ Ð´Ð»Ñ Ð¾Ð±ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð¼Ð¾Ð´ÐµÐ»ÐµÐ¹
â”‚   â”œâ”€â”€ api/               # FastAPI Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ
â”‚   â””â”€â”€ monitoring/        # ÐœÐ¾Ð´ÑƒÐ»Ð¸ Ð´Ð»Ñ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³Ð°
â”œâ”€â”€ tests/                  # Ð¢ÐµÑÑ‚Ñ‹
â”œâ”€â”€ scripts/                # Ð¡ÐºÑ€Ð¸Ð¿Ñ‚Ñ‹ Ð´Ð»Ñ Ð·Ð°Ð¿ÑƒÑÐºÐ°
â”œâ”€â”€ .github/workflows/      # GitHub Actions
â”œâ”€â”€ dvc.yaml               # DVC pipeline
â”œâ”€â”€ Dockerfile             # Docker ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ
â””â”€â”€ requirements.txt       # Ð—Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸
``

## Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð¸ Ð·Ð°Ð¿ÑƒÑÐº

### 1. ÐšÐ»Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ñ
``bash
git clone https://github.com/sstanna/credit-default-prediction.git
cd credit-default-prediction
``

### 2. Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹
``bash
pip install -r requirements.txt
``

### 3. ÐŸÐ¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ…
``bash
python -m src.data.load_data
``

### 4. ÐžÐ±ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð¼Ð¾Ð´ÐµÐ»Ð¸
``bash
python scripts/train_models.py
``

### 5. Ð—Ð°Ð¿ÑƒÑÐº API
``bash
python scripts/run_api.py
# Ð¸Ð»Ð¸
uvicorn src.api.app:app --host 0.0.0.0 --port 8000
``

### 6. Ð—Ð°Ð¿ÑƒÑÐº Ñ‚ÐµÑÑ‚Ð¾Ð²
``bash
pytest tests/ -v
``

### 7. ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ð´Ñ€Ð¸Ñ„Ñ‚Ð°
``bash
python scripts/monitor_drift.py
``

### 8. Docker Ð·Ð°Ð¿ÑƒÑÐº
``bash
docker build -t credit-default-api .
docker run -p 8000:8000 credit-default-api
``

## ÐšÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ñ‹ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°

### 1. ÐŸÐ¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ° Ð¸ Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ…
- Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¸Ð· UCI ML Repository
- Feature Engineering (Ð°Ð³Ñ€ÐµÐ³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ñ€Ð¸Ð·Ð½Ð°ÐºÐ¸, Ð±Ð¸Ð½Ð½Ð¸Ð½Ð³)
- Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ Ñ Great Expectations

### 2. ÐžÐ±ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð¼Ð¾Ð´ÐµÐ»Ð¸
- Sklearn Pipeline Ñ Ð¿Ñ€ÐµÐ´Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¾Ð¹
- ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð¿Ð¾Ð´Ð±Ð¾Ñ€ Ð³Ð¸Ð¿ÐµÑ€Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð¾Ð²
- ÐœÐµÑ‚Ñ€Ð¸ÐºÐ¸: ROC-AUC, Precision, Recall, F1-Score

### 3. Ð­ÐºÑÐ¿ÐµÑ€Ð¸Ð¼ÐµÐ½Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ
- MLflow Tracking Ð´Ð»Ñ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ ÑÐºÑÐ¿ÐµÑ€Ð¸Ð¼ÐµÐ½Ñ‚Ð¾Ð²
- Ð’ÐµÑ€ÑÐ¸Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¼Ð¾Ð´ÐµÐ»ÐµÐ¹ Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ñ DVC

### 4. Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¸ CI/CD
- Unit-Ñ‚ÐµÑÑ‚Ñ‹ Ñ pytest
- GitHub Actions Ð´Ð»Ñ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð³Ð¾ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ
- Ð›Ð¸Ð½Ñ‚Ð¸Ð½Ð³ Ñ flake8 Ð¸ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ñ black

### 5. Ð Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ðµ
- FastAPI REST API
- Docker ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ð¸Ð·Ð°Ñ†Ð¸Ñ
- ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ð´Ñ€Ð¸Ñ„Ñ‚Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ…

## API Endpoints

- GET / - Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¾ API
- POST /predict - ÐŸÑ€ÐµÐ´ÑÐºÐ°Ð·Ð°Ð½Ð¸Ðµ Ð´ÐµÑ„Ð¾Ð»Ñ‚Ð°
- GET /health - ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð·Ð´Ð¾Ñ€Ð¾Ð²ÑŒÑ ÑÐµÑ€Ð²Ð¸ÑÐ°
- POST /predict_batch - ÐŸÐ°ÐºÐµÑ‚Ð½Ð¾Ðµ Ð¿Ñ€ÐµÐ´ÑÐºÐ°Ð·Ð°Ð½Ð¸Ðµ
- GET /model_info - Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¾ Ð¼Ð¾Ð´ÐµÐ»Ð¸

## ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ API

``python
import requests

url = "http://localhost:8000/predict"
data = {
    "LIMIT_BAL": 20000,
    "SEX": 2,
    "EDUCATION": 2,
    "MARRIAGE": 1,
    "AGE": 24,
    "PAY_0": 2,
    "PAY_2": 2,
    "PAY_3": -1,
    "PAY_4": -1,
    "PAY_5": -2,
    "PAY_6": -2,
    "BILL_AMT1": 3913,
    "BILL_AMT2": 3102,
    "BILL_AMT3": 689,
    "BILL_AMT4": 0,
    "BILL_AMT5": 0,
    "BILL_AMT6": 0,
    "PAY_AMT1": 0,
    "PAY_AMT2": 689,
    "PAY_AMT3": 0,
    "PAY_AMT4": 0,
    "PAY_AMT5": 0,
    "PAY_AMT6": 0
}

response = requests.post(url, json=data)
print(response.json())
``

## ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³

Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ src/monitoring/drift_monitor.py Ð¾Ñ‚ÑÐ»ÐµÐ¶Ð¸Ð²Ð°ÐµÑ‚ Ð´Ñ€Ð¸Ñ„Ñ‚ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¸ Ð²Ñ‹Ñ‡Ð¸ÑÐ»ÑÐµÑ‚ Population Stability Index (PSI).

``python
from src.monitoring.drift_monitor import DataDriftMonitor

monitor = DataDriftMonitor(reference_data)
report = monitor.generate_drift_report(new_data)
``

## MLflow Tracking

Ð—Ð°Ð¿ÑƒÑÐº MLflow UI:
``bash
mlflow ui
``

ÐžÑ‚ÐºÑ€Ð¾Ð¹Ñ‚Ðµ http://localhost:5000 Ð² Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€Ðµ Ð´Ð»Ñ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð° ÑÐºÑÐ¿ÐµÑ€Ð¸Ð¼ÐµÐ½Ñ‚Ð¾Ð².

## DVC Pipeline

Ð—Ð°Ð¿ÑƒÑÐº Ð¿Ð°Ð¹Ð¿Ð»Ð°Ð¹Ð½Ð°:
``bash
dvc repro
``

## Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ

Ð—Ð°Ð¿ÑƒÑÐº Ð²ÑÐµÑ… Ñ‚ÐµÑÑ‚Ð¾Ð²:
``bash
pytest tests/ -v --cov=src
``

Ð—Ð°Ð¿ÑƒÑÐº Ð»Ð¸Ð½Ñ‚Ð¸Ð½Ð³Ð°:
``bash
flake8 src tests
black src tests
``

## Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹

- **Ð”Ð°Ñ‚Ð°ÑÐµÑ‚:** 30,000 Ð·Ð°Ð¿Ð¸ÑÐµÐ¹ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ð½Ñ‹
- **Ð¦ÐµÐ»ÐµÐ²Ð°Ñ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ð°Ñ:** 22.12% Ð´ÐµÑ„Ð¾Ð»Ñ‚Ð¾Ð² (6,636 Ð¸Ð· 30,000)
- **Feature Engineering:** 4 Ð½Ð¾Ð²Ñ‹Ñ… Ð¿Ñ€Ð¸Ð·Ð½Ð°ÐºÐ° ÑÐ¾Ð·Ð´Ð°Ð½Ñ‹
- **ÐœÐ¾Ð´ÐµÐ»Ð¸:** 3 Ð°Ð»Ð³Ð¾Ñ€Ð¸Ñ‚Ð¼Ð° Ð¾Ð±ÑƒÑ‡ÐµÐ½Ñ‹ Ñ Ð³Ð¸Ð¿ÐµÑ€Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð°Ð¼Ð¸
- **API:** REST API Ð³Ð¾Ñ‚Ð¾Ð² Ðº Ð¿Ñ€Ð¾Ð´Ð°ÐºÑˆÐ½ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÑŽ
- **ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³:** PSI Ð´Ñ€Ð¸Ñ„Ñ‚ Ð´ÐµÑ‚ÐµÐºÑ‚Ð¾Ñ€ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½

## ÐÐ²Ñ‚Ð¾Ñ€

ML Engineer - Credit Department (sstanna)

## Ð›Ð¸Ñ†ÐµÐ½Ð·Ð¸Ñ

MIT License
